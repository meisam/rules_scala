# Remove once Bazel 8 becomes the minimum supported version.
common --noenable_workspace --incompatible_use_plus_in_repo_names

# Ensure that the `MODULE.bazel.lock` files don't change silently.
# - Set to `refresh` to actually update the lockfiles.
# - Set to `update` when testing a Bazel version different from .bazelversion
#   (or comment it out, since `update` is the default).
common --lockfile_mode=error

# Uncomment to run tests under `WORKSPACE`. Remove once Bazel 9 becomes the
# minimum supported version.
#common --enable_workspace --noenable_bzlmod

# Uncomment for WORKSPACE builds for Bazel [8.0.0, 8.3.0) per:
# https://github.com/bazelbuild/rules_java/releases/tag/8.12.0
#common --repositories_without_autoloads=bazel_features_version,bazel_features_globals

# Remove once Bazel 9 becomes the default.
# - https://bazel.build/reference/command-line-reference#flag--incompatible_enable_proto_toolchain_resolution
# - https://github.com/bazelbuild/bazel/releases/tag/9.0.0
# - https://blog.bazel.build/2026/01/20/bazel-9.html#prebuilt-protobuf-compiler
common --incompatible_enable_proto_toolchain_resolution

# Remove once protobuf 34 becomes the default.
# - https://protobuf.dev/news/2026-01-16/
common --@rules_scala//protoc:prefer_prebuilt_protoc

build --enable_platform_specific_config

# Use Java 17+ required for Scala 3.8+
build --tool_java_runtime_version=17
build --java_runtime_version=17

#Windows needs --worker_quit_after_build due to workers not being shut down when the compiler tools need to be rebuilt (resulting in 'file in use' errors). See Bazel Issue#10498.

build:windows --worker_quit_after_build --enable_runfiles 
